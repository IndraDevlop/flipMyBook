<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <title>Animation CSS</title>
  </head>
  <body>
    <audio id="birthdayMusic" loop>
      <source src="./music/music.mp3" type="audio/mpeg">
    </audio>
    <div id="overlay">
      <div class="overlay-content">
          <h2>Aku punya sesuatu buat kamu</h2>
          <button id="startBtn">cepet pencet tombol love nyaaa üëâ <span class="heart-icon">‚ù§Ô∏è</span></button>
      </div>
    </div>
    <div class="card">
      <div class="cover">
        <div class="cover-front">
          <img src="./images/cover.jpg" alt="Foto Pertama Kita">
          <div class="cover-content">
            <h1>A Year of Us</h1>
            <p>Together with you üòä</p>
          </div>
        </div>

        <div class="cover-back">
          <img src="./images/back.jpg" alt="">
          <div class="cover-back-content">
            <h2>Since Day One</h2> <p>Every moment with you is a gift.</p>
          </div>
        </div>
      </div>

      <div class="page page-1">
        <div class="page-front">
          <p id="typing-text" data-text="Barakallah fii umrik, Sayang! üéÇ \n Ciye yang makin dewasa! Semoga makin baik hatinya, makin sayang sama aku, dan... ambekannya dikurangin dikit ya biar makin cantik \n Di hari spesialmu ini, aku berharap kamu bisa jadi pribadi yang lebih sabar dan kuat lagi. Harapan-harapan kamu? Aku yakin pasti tercapai asalkan kamu konsisten dan nggak gampang nyerah. tolong lebih peduli sama badan sendiri ya, jangan asal jajan dan harus disiplin makannya (kalo ngga nanti kamu yang aku makan üòå). Sehat itu mahal, dan aku mau kamu sehat terus buat nemenin aku. Happy birthday ya sayangkuu! ü•≥ \n ditunggu traktirannyaüíñ --> ">
          </p>
        </div>
        <div class="page-back">
          <video id="memoryVideo" loop muted playsinline>
            <source src="./music/slide.mp4" type="video/mp4">
            Browser kamu tidak mendukung tag video.
          </video>
          <!-- <img src="./images/page1-back.jpg" alt=""> -->
        </div>
      </div>
      
      <div class="page page-2">
        <div class="page-front">
          <p id="typing-text-2" data-text="Nggak terasa ya, udah 487 hari lebih kita melangkah di jalan yang sama ü´∂üèª. \n kamu tau ? foto di sampul depan ini bukan cuma sekadar gambar, tapi awal dari jutaan cerita yang kita buat bersama. ü•∞ü•∞ \n maaf ya kalau terkadang aku masih jauh dari apa yang kamu harapkan, dan maaf juga kalau aku suka membuat ekpektasi kamu ga sesuai. Tapi satu hal yang perlu kamu tahu, aku selalu berusaha jadi yang terbaik buat kamu dengan segala yang aku miliki. \n Makasih ya sudah memilih untuk tetap di sini, melewati tawa, sedih, sampai drama-drama kecil kita yang bikin hubungan ini makin berwarna üòò. Love U Pull Sayangku ‚ù§Ô∏è‚ù§Ô∏è"></p>
        </div>
      </div>
    </div>
    <script>
      const card = document.querySelector('.card');
      const music = document.getElementById('birthdayMusic');
      const text1 = document.getElementById('typing-text');
      const text2 = document.getElementById('typing-text-2');
      const video = document.getElementById('memoryVideo');
      let state = 0;
      let typingStarted1 = false;
      let typingStarted2 = false;

      card.addEventListener('click', (e) => {
        const rect = card.getBoundingClientRect();
        const isLeft = (e.clientX - rect.left) < rect.width / 2;

        if (state === 0) {
          card.classList.add('open');
          state = 1;

          music.play().then(() => {
          console.log("Musik diputar!");
          }).catch(error => {
              console.log("Gagal putar musik: ", error);
          });
          music.play().catch(error => console.log("User must interact first"));

          confetti({
            particleCount: 150,
            spread: 70,
            origin: { y: 0.6 },
            colors: ['#ff69b4', '#ffd700', '#ffffff']
          });

          if (video) {
            video.play();
          }
          
          if (!typingStarted1 && text1) {
            typingStarted1 = true;
            setTimeout(() => { startTyping(text1); }, 800);
          }
        } 
        else if (state === 1) {
          card.classList.add('page-open');
          state = 2;

          if (!typingStarted2 && text2) {
            typingStarted2 = true;
            setTimeout(() => { startTyping(text2); }, 800);
          }
        } 
        else {
          if (isLeft) {
            card.classList.remove('page-open');
            state = 1;
          } else {
            card.classList.remove('open', 'page-open');
            state = 0;
            typingStarted1 = false;
            typingStarted2 = false;
            // music.pause(); 
            // music.currentTime = 0;
          }
        }
      });

      function createHeart() {
        const heart = document.createElement('div');
        heart.classList.add('heart');
        heart.innerHTML = '‚ù§Ô∏è'; // Karakter hati
        
        // Posisi horizontal acak
        heart.style.left = Math.random() * 100 + "vw";
        
        // Ukuran acak
        const size = Math.random() * 20 + 10 + "px";
        heart.style.fontSize = size;
        
        // Durasi jatuh acak (antara 3 - 6 detik)
        const duration = Math.random() * 3 + 3;
        heart.style.animationDuration = duration + "s";
        
        // Transparansi acak
        heart.style.opacity = Math.random();

        document.body.appendChild(heart);

        // Hapus elemen setelah animasi selesai agar tidak memberatkan browser
        setTimeout(() => {
          heart.remove();
        }, duration * 1000);
      }

      setInterval(createHeart, 300);

      document.getElementById('startBtn').addEventListener('click', function() {
        music.play().then(() => {
            music.pause();
            music.currentTime = 0;
        });

        const overlay = document.getElementById('overlay');
        overlay.style.transition = "opacity 0.8s ease";
        overlay.style.opacity = "0";
        
        setTimeout(() => {
            overlay.style.display = 'none';
        }, 800);
      });

      function startTyping(element) {
        const fullText = element.getAttribute('data-text');
        if (!fullText) return;

        let charIndex = 0;
        element.innerHTML = ""; 

        function type() {
          if (charIndex < fullText.length) {
            let char = fullText.charAt(charIndex);
            
            if (char === "\\" && fullText.charAt(charIndex + 1) === "n") {
              element.innerHTML += "<br>";
              charIndex += 2;
            } else {
              element.innerHTML += char;
              charIndex++;
            }
            setTimeout(type, 40); // Sedikit lebih cepat (40ms) agar tidak bosan menunggu
          }
        }
        type();
      }
    </script>
  </body>
</html>


